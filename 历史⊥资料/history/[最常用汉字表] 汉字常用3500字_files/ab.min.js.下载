"use strict";
var _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ?
function(e) {
    return typeof e
}: function(e) {
    return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol": typeof e
}; !
function() {
    var e = function(e) {
        var o = {};
        if (e.name.indexOf(" ") >= 0) return ! 1;
        if (!e.name) return ! 1;
        if (o.name = e.name, e.gaSupport ? o.gaSupport = e.gaSupport: o.gaSupport = !1, !e.customVarSlot && e.gaSupport) return ! 1;
        if (o.customVarSlot = e.customVarSlot, !e.variations) return ! 1;
        o.variations = e.variations,
        e.chooseVariationNumber ? o.chooseVariationNumber = e.chooseVariationNumber: o.chooseVariationNumber = Math.floor(Math.random() * t.keys(o.variations).length),
        o.newCookieSet = null;
        var n = "abjs_" + o.name,
        a = t.queryString();
        if (o.cookieVariation = t.getCookie(n), o.queryVariation = a["abjs-setvar-" + o.name], t.isFunction(o.variations[o.queryVariation]) ? o.assignedVariation = o.queryVariation: o.assignedVariation = o.cookieVariation, "yes" === a["abjs-setcookie"] && (o.newCookieSet = !0), "" === o.assignedVariation || !t.isFunction(o.variations[o.assignedVariation])) {
            var i = o.chooseVariationNumber;
            o.assignedVariation = t.keys(o.variations)[i],
            o.newCookieSet = !0
        }
        if (!0 === o.newCookieSet) {
            var r = e.cookiePath || window.location.pathname;
            t.setCookie(n, o.assignedVariation, 365, r, e.domain)
        }
        return o.execute = function() {
            t.contentLoaded(window,
            function() {
                o.variations[o.assignedVariation]()
            })
        },
        o.execute(),
        o.gaSupport && (window._gaq = window._gaq || [], window._gaq.push(["_setCustomVar", o.customVarSlot, "abjs_" + o.name, "abjs_" + o.assignedVariation, 1])),
        o
    },
    t = {};
    t.setCookie = function(e, t, o, n, a) {
        var i = new Date;
        i.setDate(i.getDate() + o),
        console.log(i.toUTCString());
        var r = escape(t) + (null === o ? "": "; expires=" + i.toUTCString()),
        s = e + "=" + r + "; path=" + n;
        a && (s += "; domain=" + a),
        document.cookie = s
    },
    t.getCookie = function(e) {
        var t, o, n, a = document.cookie.split(";");
        for (t = 0; t < a.length; t++) if (o = a[t].substr(0, a[t].indexOf("=")), n = a[t].substr(a[t].indexOf("=") + 1), (o = o.replace(/^\s+|\s+$/g, "")) == e) return unescape(n);
        return ""
    },
    t.keys = function(e) {
        if (e !== Object(e)) throw new TypeError("ABTestUtils.keys called on non-object");
        var t = [],
        o = null;
        for (o in e) Object.prototype.hasOwnProperty.call(e, o) && t.push(o);
        return t
    },
    t.isFunction = function(e) {
        return !! (e && e.constructor && e.call && e.apply)
    },
    t.contentLoaded = function(e, t) {
        var o = !1,
        n = !0,
        a = e.document,
        i = a.documentElement,
        r = a.addEventListener ? "addEventListener": "attachEvent",
        s = a.addEventListener ? "removeEventListener": "detachEvent",
        c = a.addEventListener ? "": "on",
        u = function n(i) {
            "readystatechange" == i.type && "complete" != a.readyState || (("load" == i.type ? e: a)[s](c + i.type, n, !1), !o && (o = !0) && t.call(e, i.type || i))
        };
        if ("complete" == a.readyState) t.call(e, "lazy");
        else {
            if (a.createEventObject && i.doScroll) {
                try {
                    n = !e.frameElement
                } catch(e) {}
                n &&
                function e() {
                    try {
                        i.doScroll("left")
                    } catch(t) {
                        return void setTimeout(e, 50)
                    }
                    u("poll")
                } ()
            }
            a[r](c + "DOMContentLoaded", u, !1),
            a[r](c + "readystatechange", u, !1),
            e[r](c + "load", u, !1)
        }
    },
    t.queryString = function() {
        for (var e = {},
        t = window.location.search.substring(1).split("&"), o = 0; o < t.length; o++) {
            var n = t[o].split("=");
            e[unescape(n[0])] = unescape(n[1])
        }
        return e
    },
    "object" === ("undefined" == typeof exports ? "undefined": _typeof(exports)) ? module.exports = {
        ABTest: e,
        ABTestUtils: t
    }: (window.ABTest = e, window.ABTestUtils = t)
} ();